### 简介  

一个对象的状态可以分为两种：  

* 内部状态：    
内部状态不会随着环境的改变而改变 ，所以存储在对象的内部  
* 外部状态：  
外部状态会随着环境的改变而改变，所以当对象需要它的时候，通过方法参数的形式传递  

比如，水果的名称是水果的内部状态；水果的重量是水果的外部状态。  

享元模式是**通过共享**，**避免重复创建内容相同的对象**，从而节省内存。  

在享元模式中，被共享的对象就是**享元对象**。客户端不会直接创建享元对象，而必须通过**享元工厂**来创建，客户端还要为 享元工厂 提供 要创建的享元对象 的*内部状态*。享元工厂首先根据这个 *内部状态* 查看自己的 **缓存** ，如果曾经创建过*内容相同*的享元对象，则直接返回该对象。  
否则，享元工厂需要使用这个*内部状态*来创建享元对象（这也就意味着新创建的享元对象需要保存这些内部状态），创建后，放到自己的缓存中，并返回之。  

享元模式 和 单例模式 的区别是：  

* 在程序运行期间，**一个类只有一个实例**，这就是单例模式
* **一个类可以有多个实例，但是不存在内容相同（内部状态）的实例**，这就是享元模式  

---  

### 角色  

* 抽象享元角色  
为所有的具体享元角色定义公共的接口，**外部状态可以通过方法的参数传递给享元对象**     
* 具体享元角色(单纯享元角色)    
继承或实现抽象享元角色。需要**保存内部状态**  
* 复合享元角色    
**不可以被共享**（因此很少使用！），但是可以分解成多个可被共享的*单纯享元对象*    
* 享元工厂    
负责创建和管理具体享元对象（***享元工厂通常是单例的***）  

---

### UML类图  

![flyweight.png](http://timd.cn/content/images/pictures/flyweight.png)  
